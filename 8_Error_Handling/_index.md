---
title: "8. 错误处理"
anchor: "8_Error_Handling"
weight: 80000
rank: "h1"
---

在无法成功结束一条流时，QUIC允许应用对一条流发起中止（重置）并将原因传递给对端，详见《[QUIC传输](../RFC9000_Chinese_Simplified)》的[第2.4章](../RFC9000_Chinese_Simplified/#2.4._Operations_on_Streams)。
这被称为“流错误”。
HTTP/3实现可以决定要不要关掉一条QUIC流并将原因告知对端。
[第8.1章](#8.1_HTTP3_Error_Codes)中定义了错误码的编码方式。
同样是用于表达错误的HTTP状态码，流错误与之有一些区别。
流错误表示发送方并没有传输或处理完整个请求或响应，而HTTP状态码表示的是对已成功接收到的请求的处理结果。

如果需要终止一整条连接，QUIC也提供了一种传达关闭理由的机制，详见《[QUIC传输](../RFC9000_Chinese_Simplified)》的[第5.3章](../RFC9000_Chinese_Simplified/#5.3_Operations_on_Connections)。
这被称为“连接错误”。
与流错误类似，HTTP/3实现可以决定要不要关闭一条QUIC连接并使用[第8.1章](#8.1_HTTP3_Error_Codes)中的错误码将理由告知对端。

尽管关闭流或连接的理由被称作为“错误”，但是这些操作并不一定表示在连接上或实现中存在问题。
例如，一条流可能在请求的资源不再被需要时被重置。

在某些情况下，终端{{< req_level MAY >}}选择将流错误视作为连接错误，用关闭整条连接的方式来响应单条流上出现的流错误。
实现在做出此决定前需要考虑这么做对于在途请求的影响。

由于无需协商即可定义新的错误码（详见[第9章](#9_Extensions_to_HTTP3)），所以如果在意料外的上下文中使用了某错误码，或接收到了一个未知类型的错误码，那么{{< req_level MUST >}}将该情况视作类型为`H3_NO_ERROR`（无错误）的错误。
然而无论哪个错误码，关闭一条流总会带来其他影响，[第4.1章](#4.1_HTTP_Message_Framing)中就有一个例子。
