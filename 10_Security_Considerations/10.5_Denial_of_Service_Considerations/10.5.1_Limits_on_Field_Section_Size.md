---
title: "10.5.1. 对字段组尺寸的限制"
anchor: "10.5.1_Limits_on_Field_Section_Size"
weight: 100501
rank: "h3"
---

A large field section (Section 4.1) can cause an implementation to commit a large amount of state. Header fields that are critical for routing can appear toward the end of a header section, which prevents streaming of the header section to its ultimate destination. This ordering and other reasons, such as ensuring cache correctness, mean that an endpoint likely needs to buffer the entire header section. Since there is no hard limit to the size of a field section, some endpoints could be forced to commit a large amount of available memory for header fields.

巨大的字段组（详见[第4.1章]()）会导致实现占用大量空间来存储状态数据。
对路由来说很关键的标头字段可能出现在头部的末尾，这会阻碍头部数据被路由至其目的地。
这种顺序上的问题和其他因素，如为了确保缓存的有效性，意味着终端可能需要将整个头部缓存下来。
由于不存在对于字段组的硬性限制，一些终端可能不得不占用大量的可用内存来存储标头字段。

An endpoint can use the SETTINGS_MAX_FIELD_SECTION_SIZE (Section 4.2.2) setting to advise peers of limits that might apply on the size of field sections. This setting is only advisory, so endpoints MAY choose to send field sections that exceed this limit and risk having the request or response being treated as malformed. This setting is specific to an HTTP/3 connection, so any request or response could encounter a hop with a lower, unknown limit. An intermediary can attempt to avoid this problem by passing on values presented by different peers, but they are not obligated to do so.

终端可以使用设置`SETTINGS_MAX_FIELD_SECTION_SIZE`（详见[第4.2.2章]()）来向对端提示它可能会对字段组尺寸施加的限制。
这个设置只是提示性质的，所以终端**可以**选择发送超过此限制的字段组，并承担此请求或响应被视作畸形的风险。
该设置是特定于某条HTTP/3连接的，所以任何请求或响应都可能在中转过程中遇到一个更低的且未知的限制。
中间设备可以通过传递来自不同终端的值的方式来避免此问题，不过它们并没有义务这么做。

A server that receives a larger field section than it is willing to handle can send an HTTP 431 (Request Header Fields Too Large) status code ([RFC6585]). A client can discard responses that it cannot process.

如果终端接收到的字段组可能比它愿意处理的还要大，那么作为服务器时它可以发送HTTP状态码`431`（请求标头字段过大，详见《[RFC6585]()》），而作为客户端时它可以丢弃无法处理的响应。
